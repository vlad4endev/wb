# üîê –û—Ç—á–µ—Ç –æ–± –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ —Å –ø–æ–∏—Å–∫–æ–º —Å–ª–æ—Ç–æ–≤

## ‚úÖ **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!**

### **üîó –ö–∞–∫ —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:**

#### 1. **API —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤** (`/api/tokens`)
```typescript
// src/app/api/tokens/route.ts:69-75
const token = await prisma.userToken.create({
  data: {
    userId: user.id,  // ‚Üê –¢–æ–∫–µ–Ω –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    category: validatedData.category,
    tokenEncrypted: encryptedToken,
  },
});
```

#### 2. **API –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤** (`/api/tokens`)
```typescript
// src/app/api/tokens/route.ts:11-14
const tokens = await prisma.userToken.findMany({
  where: { userId: user.id },  // ‚Üê –ü–æ–ª—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  orderBy: { createdAt: 'desc' },
});
```

### **üîç –ö–∞–∫ —Ç–æ–∫–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ —Å–ª–æ—Ç–æ–≤:**

#### 1. **–°–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞ —Å–ª–æ—Ç–æ–≤** (`continuous-slot-search-service.ts`)
```typescript
// src/lib/services/continuous-slot-search-service.ts:81-100
const suppliesToken = await prisma.userToken.findFirst({
  where: {
    userId: config.userId,  // ‚Üê –ò—â–µ–º —Ç–æ–∫–µ–Ω SUPPLIES –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    category: 'SUPPLIES',
    isActive: true,
  },
});

if (!suppliesToken) {
  throw new Error(`No active supplies token found. User has ${userTokens.length} tokens.`);
}
```

#### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏** (`/api/tasks`)
```typescript
// src/app/api/tasks/route.ts:105-137
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–∏—Å–∫
const searchConfig = {
  taskId: task.id,
  userId: user.id,  // ‚Üê –ü–µ—Ä–µ–¥–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø–æ–∏—Å–∫
  // ... –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
};

continuousSlotSearchService.startContinuousSearch(searchConfig);
```

### **üìä –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**

```sql
-- –¢–∞–±–ª–∏—Ü–∞ user_tokens
CREATE TABLE user_tokens (
  id TEXT PRIMARY KEY,
  user_id TEXT NOT NULL,  -- ‚Üê –°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
  category TEXT NOT NULL, -- SUPPLIES, STATISTICS, etc.
  token_encrypted TEXT NOT NULL,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW()
);

-- –°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
ALTER TABLE user_tokens 
ADD CONSTRAINT fk_user_tokens_user_id 
FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE;
```

### **üîÑ –ü–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã:**

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç –≤ —Å–∏—Å—Ç–µ–º—É** ‚Üí –ø–æ–ª—É—á–∞–µ—Ç `userId`
2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω** ‚Üí —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å `userId`
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É** ‚Üí –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è `userId` –≤ –ø–æ–∏—Å–∫
4. **–°–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞** ‚Üí –∏—â–µ—Ç —Ç–æ–∫–µ–Ω SUPPLIES –¥–ª—è `userId`
5. **–¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Wildberries
6. **–ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è** ‚Üí —Å–ª–æ—Ç—ã –∏—â—É—Ç—Å—è —Å —Ç–æ–∫–µ–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

- ‚úÖ **–¢–æ–∫–µ–Ω—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º** - –∫–∞–∂–¥—ã–π –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ç–æ–∫–µ–Ω—ã
- ‚úÖ **–¢–æ–∫–µ–Ω—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã** - —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞** - –≤—Å–µ API —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** - –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–¥–∞–ª—è—é—Ç—Å—è –µ–≥–æ —Ç–æ–∫–µ–Ω—ã

### **üõ†Ô∏è –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**

1. **–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí `http://localhost:3000/settings`
2. **–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–¢–æ–∫–µ–Ω—ã"**
3. **–í—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é** ‚Üí "–ü–æ—Å—Ç–∞–≤–∫–∏ (FBW)" –¥–ª—è SUPPLIES
4. **–í–≤–µ—Å—Ç–∏ —Ç–æ–∫–µ–Ω** ‚Üí —Ç–æ–∫–µ–Ω API Wildberries
5. **–ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω"** ‚Üí —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### **üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:**

–ï—Å–ª–∏ –ø–æ–∏—Å–∫ —Å–ª–æ—Ç–æ–≤ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–ï—Å—Ç—å –ª–∏ —Ç–æ–∫–µ–Ω SUPPLIES:**
   ```bash
   curl -X GET http://localhost:3000/api/tokens \
     -H "Cookie: auth-token=YOUR_TOKEN"
   ```

2. **–ê–∫—Ç–∏–≤–µ–Ω –ª–∏ —Ç–æ–∫–µ–Ω:**
   - –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "–ê–∫—Ç–∏–≤–µ–Ω" —Ä—è–¥–æ–º —Å —Ç–æ–∫–µ–Ω–æ–º
   - –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö `is_active = true`

3. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è:**
   - –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é `SUPPLIES`
   - –ù–µ `STATISTICS` –∏–ª–∏ –¥—Ä—É–≥–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

### **üìà –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**

- ‚úÖ **–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
- ‚úÖ **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø–æ–∏—Å–∫–µ** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

## üéØ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**

–°–∏—Å—Ç–µ–º–∞ —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å –ø–æ–∏—Å–∫–æ–º —Å–ª–æ—Ç–æ–≤. –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π —Ç–æ–∫–µ–Ω SUPPLIES, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –µ–≥–æ –∑–∞–¥–∞—á –ø–æ–∏—Å–∫–∞ —Å–ª–æ—Ç–æ–≤. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–±–µ—Å–ø–µ—á–µ–Ω—ã.

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: $(date)*
*–°—Ç–∞—Ç—É—Å: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ*
